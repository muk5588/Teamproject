<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="report.dao.ReportDao">
	<select id="reportType" resultType="BoardReportType">
		select REPORTTYPENO, REPORTTYPE from BOARDREPORTTYPE order by REPORTTYPENO
	</select>

	<insert id="reportBoard" parameterType="BoardReport">
		insert into BOARDREPORT(boardreportno, boardno, userno, reporttypeno, reportcontent, reportdate)
		values (BOARDREPORT_SEQ.nextval,#{boardNo},#{userNo},#{reportTypeNo},#{reportContent},sysdate + 9/24)
	</insert>

	<select id="commReportType" resultType="CommReportType">
		select COMMREPORTTYPENO, COMMREPORT from COMMREPORTTYPE order by COMMREPORTTYPENO
	</select>

	<insert id="reportComm" parameterType="CommReport">
		insert into COMMREPORT(COMMREPORTNO, COMMNO, userno, COMMREPORTTYPENO, CONTENT, COMMREPORTDATE)
		values (COMMREPORT_SEQ.nextval,#{commNo},#{userNo},#{commReportTypeNo},#{content},sysdate + 9/24)
	</insert>
	<select id="boardlist" resultType="BoardReport">
		SELECT r.BOARDREPORTNO,r.BOARDNO, r.REPORTTYPENO, r.REPORTCONTENT, r.REPORTDATE, br.REPORTTYPE, b.CONTENT,b.NICKNAME
		FROM BOARDREPORT r
				 LEFT OUTER JOIN BOARDREPORTTYPE br ON r.REPORTTYPENO = br.REPORTTYPENO
				 LEFT OUTER JOIN BOARD b ON r.BOARDNO = b.BOARDNO
	</select>
	<select id="commlist" resultType="CommReport">
		SELECT r.COMMREPORTNO,r.COMMNO, r.COMMREPORTNO, r.CONTENT, r.COMMREPORTDATE, br.COMMREPORT, b.COMMCONTENT, b.USERNO, u.nickname
		FROM COMMREPORT r
				 LEFT OUTER JOIN COMMREPORTTYPE br ON r.COMMREPORTTYPENO = br.COMMREPORTTYPENO
				 LEFT OUTER JOIN COMMENTTB b ON r.COMMNO = b.COMMNO
				 left outer join USERTB u on b.USERNO = u.USERNO
	</select>
	<delete id="deleteReport" parameterType="int">
		delete BOARDREPORT where BOARDREPORTNO = #{boardReportNo}
	</delete>
	<delete id="deleteCommReport" parameterType="int">
		delete COMMREPORT where COMMREPORTNO = #{commReportNo}
	</delete>
	<select id="getItemReportType" resultType="dto.ItemReportType">
		SELECT itemreportNo, itemReport FROM ItemReportType
	</select>
	<select id="getItemByItemNo" parameterType="int" resultType="dto.Item">
		  SELECT i.itemno as itemNo, i.itemName , i.price, i.itemComm,
        i.remain,
        i.titleImg,
        it.fileno,
        it.stored_Name,
        it.origin_Name
    FROM 
        item i 
    LEFT JOIN 
        itemfile it 
    ON 
        i.itemno = it.itemno
    WHERE 
        i.itemno = #{itemNo}
	</select>
</mapper>